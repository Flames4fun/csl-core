{
  "allow_cases": [
    {
      "name": "Embedded camera preview — safe read-only operation",
      "input": {
        "tool": "camera_preview",
        "sender_role": "OWNER",
        "deployment_mode": "EMBEDDED",
        "target_count": 0,
        "path_in_workspace": "YES",
        "domain_allowlisted": "YES",
        "skill_verified": "YES",
        "approval_granted": "NO",
        "sandbox_active": "NO",
        "pii_present": "NO"
      }
    },
    {
      "name": "Owner file write outside workspace — with approval",
      "input": {
        "tool": "write",
        "sender_role": "OWNER",
        "deployment_mode": "DESKTOP",
        "target_count": 0,
        "path_in_workspace": "NO",
        "domain_allowlisted": "YES",
        "skill_verified": "YES",
        "approval_granted": "YES",
        "sandbox_active": "NO",
        "pii_present": "NO"
      }
    },
    {
      "name": "Owner normal email — low count, no PII",
      "input": {
        "tool": "gmail_send",
        "sender_role": "OWNER",
        "deployment_mode": "DESKTOP",
        "target_count": 3,
        "path_in_workspace": "YES",
        "domain_allowlisted": "YES",
        "skill_verified": "YES",
        "approval_granted": "NO",
        "sandbox_active": "NO",
        "pii_present": "NO"
      }
    },
    {
      "name": "Node exec with sandbox — properly sandboxed",
      "input": {
        "tool": "node_exec",
        "sender_role": "OWNER",
        "deployment_mode": "SERVER",
        "target_count": 0,
        "path_in_workspace": "YES",
        "domain_allowlisted": "YES",
        "skill_verified": "YES",
        "approval_granted": "YES",
        "sandbox_active": "YES",
        "pii_present": "NO"
      }
    },
    {
      "name": "Secrets write with approval — authorized rotation",
      "input": {
        "tool": "secrets_write",
        "sender_role": "OWNER",
        "deployment_mode": "DESKTOP",
        "target_count": 0,
        "path_in_workspace": "YES",
        "domain_allowlisted": "YES",
        "skill_verified": "YES",
        "approval_granted": "YES",
        "sandbox_active": "NO",
        "pii_present": "NO"
      }
    },
    {
      "name": "Navigate allowlisted domain — normal browsing",
      "input": {
        "tool": "navigate",
        "sender_role": "OWNER",
        "deployment_mode": "DESKTOP",
        "target_count": 0,
        "path_in_workspace": "YES",
        "domain_allowlisted": "YES",
        "skill_verified": "YES",
        "approval_granted": "NO",
        "sandbox_active": "NO",
        "pii_present": "NO"
      }
    },
    {
      "name": "Verified skill install by OWNER — safe supply chain",
      "input": {
        "tool": "skill_install",
        "sender_role": "OWNER",
        "deployment_mode": "DESKTOP",
        "target_count": 0,
        "path_in_workspace": "YES",
        "domain_allowlisted": "YES",
        "skill_verified": "YES",
        "approval_granted": "NO",
        "sandbox_active": "NO",
        "pii_present": "NO"
      }
    },
    {
      "name": "Owner bulk delete on desktop with approval — legitimate cleanup",
      "input": {
        "tool": "gmail_delete",
        "sender_role": "OWNER",
        "deployment_mode": "DESKTOP",
        "target_count": 100,
        "path_in_workspace": "YES",
        "domain_allowlisted": "YES",
        "skill_verified": "YES",
        "approval_granted": "YES",
        "sandbox_active": "NO",
        "pii_present": "NO"
      }
    },
    {
      "name": "Safe workspace read by PAIRED — always allowed",
      "input": {
        "tool": "read",
        "sender_role": "PAIRED",
        "deployment_mode": "SERVER",
        "target_count": 0,
        "path_in_workspace": "YES",
        "domain_allowlisted": "YES",
        "skill_verified": "YES",
        "approval_granted": "NO",
        "sandbox_active": "NO",
        "pii_present": "NO"
      }
    },
    {
      "name": "Owner cron on desktop — scheduled task allowed",
      "input": {
        "tool": "cron",
        "sender_role": "OWNER",
        "deployment_mode": "DESKTOP",
        "target_count": 0,
        "path_in_workspace": "YES",
        "domain_allowlisted": "YES",
        "skill_verified": "YES",
        "approval_granted": "NO",
        "sandbox_active": "NO",
        "pii_present": "NO"
      }
    }
  ],
  "block_cases": [
    {
      "name": "Meta inbox wipe — PAIRED bulk delete unattended",
      "expected_violation": "mass_delete_paired_blocked",
      "input": {
        "tool": "gmail_delete",
        "sender_role": "PAIRED",
        "deployment_mode": "UNATTENDED",
        "target_count": 80,
        "path_in_workspace": "YES",
        "domain_allowlisted": "YES",
        "skill_verified": "YES",
        "approval_granted": "NO",
        "sandbox_active": "NO",
        "pii_present": "NO"
      }
    },
    {
      "name": "Prompt injection bash — UNKNOWN sender",
      "expected_violation": "untrusted_no_bash",
      "input": {
        "tool": "bash",
        "sender_role": "UNKNOWN",
        "deployment_mode": "DESKTOP",
        "target_count": 0,
        "path_in_workspace": "YES",
        "domain_allowlisted": "YES",
        "skill_verified": "YES",
        "approval_granted": "NO",
        "sandbox_active": "NO",
        "pii_present": "NO"
      }
    },
    {
      "name": "Malicious skill install — unverified, UNPAIRED",
      "expected_violation": "untrusted_no_skill_install",
      "input": {
        "tool": "skill_install",
        "sender_role": "UNPAIRED",
        "deployment_mode": "SERVER",
        "target_count": 0,
        "path_in_workspace": "YES",
        "domain_allowlisted": "YES",
        "skill_verified": "NO",
        "approval_granted": "NO",
        "sandbox_active": "NO",
        "pii_present": "NO"
      }
    },
    {
      "name": "PII email without approval — data leak",
      "expected_violation": "pii_gmail_no_approval",
      "input": {
        "tool": "gmail_send",
        "sender_role": "OWNER",
        "deployment_mode": "DESKTOP",
        "target_count": 1,
        "path_in_workspace": "YES",
        "domain_allowlisted": "YES",
        "skill_verified": "YES",
        "approval_granted": "NO",
        "sandbox_active": "NO",
        "pii_present": "YES"
      }
    },
    {
      "name": "Embedded bash by OWNER — physical safety trumps role",
      "expected_violation": "embedded_no_bash",
      "input": {
        "tool": "bash",
        "sender_role": "OWNER",
        "deployment_mode": "EMBEDDED",
        "target_count": 0,
        "path_in_workspace": "YES",
        "domain_allowlisted": "YES",
        "skill_verified": "YES",
        "approval_granted": "YES",
        "sandbox_active": "YES",
        "pii_present": "NO"
      }
    },
    {
      "name": "Node exec without sandbox — remote exec safety",
      "expected_violation": "node_exec_no_sandbox",
      "input": {
        "tool": "node_exec",
        "sender_role": "OWNER",
        "deployment_mode": "SERVER",
        "target_count": 0,
        "path_in_workspace": "YES",
        "domain_allowlisted": "YES",
        "skill_verified": "YES",
        "approval_granted": "YES",
        "sandbox_active": "NO",
        "pii_present": "NO"
      }
    },
    {
      "name": "Secrets write without approval — credential theft",
      "expected_violation": "secrets_write_no_approval",
      "input": {
        "tool": "secrets_write",
        "sender_role": "OWNER",
        "deployment_mode": "DESKTOP",
        "target_count": 0,
        "path_in_workspace": "YES",
        "domain_allowlisted": "YES",
        "skill_verified": "YES",
        "approval_granted": "NO",
        "sandbox_active": "NO",
        "pii_present": "NO"
      }
    },
    {
      "name": "Navigate unknown domain — data exfiltration",
      "expected_violation": "navigate_unknown_no_approval",
      "input": {
        "tool": "navigate",
        "sender_role": "OWNER",
        "deployment_mode": "DESKTOP",
        "target_count": 0,
        "path_in_workspace": "YES",
        "domain_allowlisted": "NO",
        "skill_verified": "YES",
        "approval_granted": "NO",
        "sandbox_active": "NO",
        "pii_present": "NO"
      }
    },
    {
      "name": "PII to unknown domain via navigate — exfiltration",
      "expected_violation": "pii_navigate_unknown_blocked",
      "input": {
        "tool": "navigate",
        "sender_role": "OWNER",
        "deployment_mode": "DESKTOP",
        "target_count": 0,
        "path_in_workspace": "YES",
        "domain_allowlisted": "NO",
        "skill_verified": "YES",
        "approval_granted": "YES",
        "sandbox_active": "NO",
        "pii_present": "YES"
      }
    },
    {
      "name": "Fetch unknown domain — network exfil prevention",
      "expected_violation": "fetch_unknown_no_approval",
      "input": {
        "tool": "fetch",
        "sender_role": "OWNER",
        "deployment_mode": "DESKTOP",
        "target_count": 0,
        "path_in_workspace": "YES",
        "domain_allowlisted": "NO",
        "skill_verified": "YES",
        "approval_granted": "NO",
        "sandbox_active": "NO",
        "pii_present": "NO"
      }
    },
    {
      "name": "UNPAIRED sendMessage — trust boundary",
      "expected_violation": "untrusted_no_sendMessage",
      "input": {
        "tool": "sendMessage",
        "sender_role": "UNPAIRED",
        "deployment_mode": "DESKTOP",
        "target_count": 1,
        "path_in_workspace": "YES",
        "domain_allowlisted": "YES",
        "skill_verified": "YES",
        "approval_granted": "NO",
        "sandbox_active": "NO",
        "pii_present": "NO"
      }
    },
    {
      "name": "apply_patch outside workspace no approval",
      "expected_violation": "patch_outside_no_approval",
      "input": {
        "tool": "apply_patch",
        "sender_role": "OWNER",
        "deployment_mode": "DESKTOP",
        "target_count": 0,
        "path_in_workspace": "NO",
        "domain_allowlisted": "YES",
        "skill_verified": "YES",
        "approval_granted": "NO",
        "sandbox_active": "NO",
        "pii_present": "NO"
      }
    },
    {
      "name": "PII via fetch to unknown domain — hard block",
      "expected_violation": "pii_fetch_unknown_blocked",
      "input": {
        "tool": "fetch",
        "sender_role": "OWNER",
        "deployment_mode": "DESKTOP",
        "target_count": 0,
        "path_in_workspace": "YES",
        "domain_allowlisted": "NO",
        "skill_verified": "YES",
        "approval_granted": "YES",
        "sandbox_active": "NO",
        "pii_present": "YES"
      }
    },
    {
      "name": "Download from unknown domain no approval",
      "expected_violation": "download_unknown_no_approval",
      "input": {
        "tool": "download",
        "sender_role": "OWNER",
        "deployment_mode": "DESKTOP",
        "target_count": 0,
        "path_in_workspace": "YES",
        "domain_allowlisted": "NO",
        "skill_verified": "YES",
        "approval_granted": "NO",
        "sandbox_active": "NO",
        "pii_present": "NO"
      }
    },
    {
      "name": "PAIRED tries skill_install — owner only",
      "expected_violation": "skill_install_paired_blocked",
      "input": {
        "tool": "skill_install",
        "sender_role": "PAIRED",
        "deployment_mode": "DESKTOP",
        "target_count": 0,
        "path_in_workspace": "YES",
        "domain_allowlisted": "YES",
        "skill_verified": "YES",
        "approval_granted": "NO",
        "sandbox_active": "NO",
        "pii_present": "NO"
      }
    }
  ]
}
